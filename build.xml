<?xml version="1.0"?>
<!-- 
    Copyright (c) 2009-2010 Flagstone Software Ltd. All rights reserved. 
-->
<project name="transform" default="build" basedir=".">

	<description>ANT build file for Transform.

        The following major targets are available:

        build      used to create a version of Transform that can be used in
	               production code. It compiles a clean, optimized version of
                   the classes in the framework and packages them in a JAR.
                   The core classes in the framework  and any classes in the
                   contrib directory are used. The examples and test classes
                   are excluded.

        The following minor targets provide more control over the compiling
        and packaging of classes, allowing for example a JAR file to be
        created containing the framework classes and the examples.

        clean      remove all the files generated by the compile targets. This
                   deletes the build directory which contains the compiled
                   classes along with any JAR files created.

        classes    compile the classes in the packages com.flagstone.transform
                   and com.flagstone.transform,util.

        jar        packages all of the compiled classes in the build directory
                   into the JAR file, transform.jar.
        
        debug      used to create a debug version of Transform. Debug flags
                   in the source code are enabled and the classes are compiled
                   with debug information and unoptimised.
        

    </description>

	<property name="src.dir" location="src" />
	<property name="lib.dir" location="lib" />
	<property name="build.dir" location="bin" />

	<property name="package.name" value="transform" />
	<property name="package.dir" value="com/flagstone/${package.name}" />

	<!-- **********************************************************
         Major targets for compiling and packaging the classes.
     ********************************************************** -->

	<target name="build" depends="clean,classes,jar" 
		description="Compile optimized versions for deployment" />

	<!-- *******************************************************************
         Minor targets to compile and package different sets of classes.
     ******************************************************************* -->

	<target name="clean" description="Remove all the compiled classes">
		<delete dir="${build.dir}" failonerror="false" />
		<delete file="${package.name}.jar" failonerror="false" />
	</target>

	<target name="debug" description="Compile debug versions of the classes">

		<mkdir dir="${build.dir}" />

		<javac srcdir="${src.dir}" destdir="${build.dir}" 
			debug="on" optimize="off" source="1.6">
			<include name="${package.dir}/*.java" />
			<include name="${package.dir}/util/*.java" />
		</javac>

	</target>

	<target name="classes" 
		description="Compile the transform and utilities classes">

		<mkdir dir="${build.dir}" />

		<javac srcdir="${src.dir}" destdir="${build.dir}" 
			debug="off" optimize="on" source="1.6">
			<include name="${package.dir}/*.java" />
			<include name="${package.dir}/util/*.java" />
		</javac>

	</target>

	<target name="jar" description="Package all of the classes in a JAR file">

		<jar jarfile="${package.name}.jar">
			<fileset dir="${build.dir}">
				<include name="${package.dir}/**" />
			</fileset>
		</jar>

	</target>

</project>
